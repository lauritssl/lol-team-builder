
<div class="notification" ng-if="!gameLobby.game.gameStarted">{{ gameLobby.userInSpot(gameLobby.currentUser.id, gameLobby.game) ? '' : gameLobby.currentUser.nickname + ', pick a slot...' }}</div>

<div class="notification" ng-if="gameLobby.game.gameStarted">{{ gameLobby.game.getUserWithTurn(gameLobby.game) ? '' : gameLobby.getUserWithTurn(gameLobby.game).nickname + ', pick a card...' }}</div>


<button class="btn btn--success" ng-click="gameLobby.startGame(gameLobby.game.id)" ng-if="!gameLobby.game.gameStarted && gameLobby.userOwnsGame()">Start game</button>

<button class="btn btn--error btn--end-game" ng-click="gameLobby.endGame(gameLobby.game.id)" ng-if="gameLobby.game.gameStarted && gameLobby.userOwnsGame()">End game</button> 
<!-- ::::::::::::::::::::::::::::::::: -->
<!-- Unassigned player Hexagon section -->
<!-- ::::::::::::::::::::::::::::::::: -->
    
    <section class="hexagon-wrapper" layout="column" layout-align="center center" ng-if="!gameLobby.game.gameStarted">
      <div class="incogneto-player-hexagon {{$index+1}}" ng-include="'gamelobby/views/incogneto-hexagon.tpl.html'" ng-repeat="user in gameLobby.game.users" ng-if="!gameLobby.userInSpot(user.id, gameLobby.game)">
      </div>
    </section>    
    
<!-- ::::::::::::::::::::::::::::::::: -->
<!-- Card deck section                 -->
<!-- ::::::::::::::::::::::::::::::::: -->
    <div class="card-deck-container" ng-if="gameLobby.game.gameStarted && !gameLobby.allSpotsAccepted(gameLobby.game)">
     <!--  <button 
        ng-if="gameLobby.userOwnsGame()" 
        ng-click="gameLobby.rollBuilds(gameLobby.game)" 
        id="lobby_btn-roll" 
        class="btn btn--success">
        ROLL ALL
      </button> -->
      <div class="card-deck">
        <article class="card" ng-click="spot.drawn || gameLobby.drawCard(gameLobby.game.id, spot)" ng-class="{'card--rotate-horizontally': spot.build.drawn, 'card--gets-overlayed': spot.build.denied, 'card--flies-to-player': spot.build.accepted}" ng-repeat="spot in gameLobby.game.spots track by $index" ng-include="'gamelobby/views/card.tpl.html'" style="z-index: {{ 10 - $index}};"></article>

       
        <div class="overlay" data-overlay-text="Admin is deciding your fate..."></div>
      </div>
       <div class="card-interactions" ng-class="{'slides-out-from-bottom': gameLobby.getNextRollableSpot(gameLobby.game).build.drawn}">
          <button class="btn btn--success" ng-if="gameLobby.userOwnsGame() || (gameLobby.userHasTurn(gameLobby.game) && !gameLobby.getNextRollableSpot(gameLobby.game).build.denied)" ng-click="gameLobby.acceptBuild(gameLobby.game, gameLobby.getNextRollableSpot(gameLobby.game))">Accept Build</button>
          <button class="btn btn--danger" ng-if="gameLobby.userHasTurn(gameLobby.game)" ng-click="gameLobby.denied(gameLobby.game, gameLobby.getNextRollableSpot(gameLobby.game))" ng-class="{'disabled' : gameLobby.getNextRollableSpot(gameLobby.game).build.denied}">Request Re-Roll</button>

          <button class="btn btn--danger" ng-if="gameLobby.userOwnsGame() && gameLobby.getNextRollableSpot(gameLobby.game).build.denied" ng-click="gameLobby.rerollSpot(gameLobby.game, gameLobby.getNextRollableSpot(gameLobby.game))" ng-class="{'disabled' : spot.build.denied}">Reroll</button>
        </div>
    </div>

    <script>
(function() {
  $(function() {
    var card, deck, initialCard, layer, notificationInitialState, rerollButtonInitialState, _i, _len;
    initialCard = $('.card').html();
    notificationInitialState = $('.notification').text();
    
    $('.card').on("click", function() {
      return $(this).toggleClass("card--rotate-horizontally");
    });
    $("[ng-click=addBuildToPlayer]").on("click", function() {
      return $('.card-deck .card').first().toggleClass('fly-away');
    });
    rerollButtonInitialState = $('[ng-click=addBuildToPlayer]').text();
    $("[ng-click=requestReroll]").on("click", function() {
      $(this).text("Wait, telling admin...").attr('disabled', 'disabled');
      return $('.notification').text('Lichine has requested a re-roll...');
    });
    return $('.revealer').on("click", function() {
      return $(this).toggleClass("reveal-it");
    });
  });

}).call(this);
</script>